// Generated by CoffeeScript 1.3.3
(function() {
  var __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  define(["views/AppView", 'app', 'views/signup'], function(AppView, app) {
    return app.views.ArtistHome = (function(_super) {

      __extends(ArtistHome, _super);

      function ArtistHome() {
        return ArtistHome.__super__.constructor.apply(this, arguments);
      }

      ArtistHome.prototype.templateName = "ArtistHome";

      ArtistHome.prototype.postRender = function() {
        return this.addView(new app.views.Signup(), '#signup');
      };

      ArtistHome.prototype.uploadFile = function(evt) {
        var _file;
        event.preventDefault();
        _file = $("#fileId").val().replace(/.+[\\\/]/, "");
        _file = 'adsf';
        return $.ajax({
          url: "/gets3credentials/" + _file,
          dataType: "text",
          success: function(res, status) {
            var formData;
            res = JSON.parse(JSON.parse(res));
            $('#s3_AWSAccessKeyId').val(res.s3KeyId);
            $('#s3_signature').val(res.s3Signature);
            $('#s3_policy').val(res.s3PolicyBase64);
            $('#s3_success_action_status').val(res.s3RedirectStatus);
            $('#s3_key').val(res.s3Key);
            $('#s3_acl').val(res.s3Acl);
            $('#s3_Content-Type').val(res.s3ContentType);
            formData = $('#uploadForm').serialize();
            top.GLOBAL_sendFormData();
            checkForSubmit();
            return {
              error: function(res, status, error) {
                return console.log('error', res, status, error);
              }
            };
          }
        });
      };

      return ArtistHome;

    })(AppView);
  });

  /*
  Old Iframe stuff
    function addIframe() {
     $('iframe').remove();
     var subframe = document.createElement('iframe');
     document.body.appendChild(subframe);
     $('iframe').hide();
     subframe.src = "iframe.html";
    };
    addIframe();
    checkForSubmit = function() {
     var timeout = setInterval(function() {
      if ($('iframe').contents().length != 0) {
       // Not received yet
      } else {
       // Got a response!
       clearInterval(timeout);
       addIframe();
      }
     }, 100);
    }
  */


}).call(this);
